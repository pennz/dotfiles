#!/bin/bash
ismac=false
[ $(uname) = Darwin ] && ismac=true

for filename in "$@"; do
    cp "$filename" ~"$filename"
    kup "$filename" & # a little slow, so put it to background
    while true; do
        #diff_content=$(diff ~"$filename" "$filename")
        #[ x = x"$diff_content" ] || cp "$filename" ~"$filename"
        #echo $diff_content
        colordiff -uw ~"$filename" "$filename" || ( cp "$filename" ~"$filename" ; kup "$filename" )
        sleep 3  # check every 5 s
    done&
done
